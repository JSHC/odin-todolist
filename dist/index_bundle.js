(()=>{"use strict";const e=new class{events={};publish(e,t){if(console.log(`publish called for event ${e} with data ${JSON.stringify(t)}`),this.events[e])for(let n of this.events[e])console.log(`calling ${n} for ${e}`),n(t)}subscribe(e,t){console.log(`subscribe: ${e}, ${t}`),this.events[e]||(this.events[e]=[]),this.events[e].push(t),console.log(`${t} subscribed to ${e}`)}unsubscribe(e,t){this.events[e]&&this.events[e].remove(this.events[e].find((e=>e===t)))}};class t{constructor(e,t,n,c,o){this.id=e,this.title=t,this.description=n,this.dueDate=c,this.isComplete=!1,this.projectId=o||1}}function n(t,n){e.publish("changePage",{page:t,data:n})}const c=[];function o(e,n,o){const d=0===(s=c).length?1:s.reduce(((e,t)=>e.id<t.value?t:e)).id+1;var s;const i=new t(d,e,n,o);return c.push(i),i}function d(){return c}const s=[new class{constructor(e,t){this.id=e,this.name=t}}(1,"Default")];function i(){return s}function a(e){return s.find((t=>t.id===e))}const l=new class{getProjectById(e){return a(e)}getTodoItemsForProject(e){return d().filter((t=>t.projectId===e))}},r=new class{render(e){const t=function(e){return c.find((t=>t.id===e))}(e);if(!t)return;const o=l.getProjectById(t.projectId),d=document.createElement("div"),s=document.createElement("h2");s.textContent=t.title;const i=document.createElement("div"),a=document.createElement("div");a.textContent="Project: ";const r=document.createElement("a");r.href="#",r.textContent=o.name,r.addEventListener("click",(e=>{e.preventDefault(),n("ProjectDetail",o.id)})),a.appendChild(r),i.appendChild(a);const p=document.createElement("div");p.textContent=t.description,i.appendChild(p);const u=document.createElement("div");u.textContent=t.dueDate,i.appendChild(u);const m=document.createElement("div");return m.textContent=t.isComplete,i.appendChild(m),d.appendChild(s),d.appendChild(i),d}},p=new class{render(){const e=i(),t=document.createElement("div");t.classList.add("project-list-container");const n=document.createElement("h2");n.textContent="Projects";const c=document.createElement("ul");c.classList.add("project-list");for(let t of e){const e=document.createElement("li");e.classList.add("project-list-item");const n=document.createElement("a");n.href="#",n.textContent=t.name,n.addEventListener("click",(e=>this.onProjectLinkClick(e,t))),e.appendChild(n),c.appendChild(e)}return t.appendChild(n),t.appendChild(c),t}onProjectLinkClick(e,t){e.preventDefault(),console.log({project:t}),n("ProjectDetail",1)}},u=new class{pageLinks=[{name:"Projects",page:"ProjectList"}];render(){const e=document.createElement("header"),t=document.createElement("nav"),n=document.createElement("ul");n.classList.add("header-links");for(let e of this.pageLinks){const t=document.createElement("li");t.classList.add("header-link-item");const c=document.createElement("a");c.href="#",c.textContent=e.name,c.addEventListener("click",(t=>this.onHeaderLinkClick(t,e))),t.appendChild(c),n.appendChild(t)}return t.appendChild(n),e.appendChild(t),e}onHeaderLinkClick(t,n){t.preventDefault(),e.publish("changePage",{page:n.page})}},m=new class{render(e){const t=a(e),c=l.getTodoItemsForProject(e);console.table(c);const o=document.createElement("div");o.classList.add("project-detail");const d=document.createElement("h2");d.textContent=t.name||"Project Details",o.appendChild(d);const s=document.createElement("div");s.classList.add("todo-items-container");for(let e of c){const t=document.createElement("div");t.classList.add("todo-item");const c=document.createElement("a");c.href="#",c.addEventListener("click",(t=>{t.preventDefault(),n("TodoItemDetail",e.id)}));const o=document.createElement("h3");o.textContent=e.title,c.appendChild(o),t.appendChild(c);const d=document.createElement("div");d.textContent=`Due date: ${e.dueDate}`,t.appendChild(d),s.appendChild(t)}return o.appendChild(s),o}};console.log("TodoList app loaded"),o("Test","Test Description","2022-12-29"),o("Test2","Test Description 2","2022-12-30"),console.table(d());const h={TodoItemDetail:r,ProjectList:p,ProjectDetail:m};e.subscribe("changePage",v),document.body.appendChild(u.render());const C=document.createElement("div");function v(e){console.log(e),e.page&&h[e.page]&&(C.innerHTML="",C.appendChild(h[e.page].render(e.data)))}C.classList.add("main-content"),document.body.appendChild(C),v({page:"ProjectList"})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxLQUFNLGUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvUHViU3ViLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Ub2RvSXRlbS9Ub2RvSXRlbS5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvdXRpbC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvVG9kb0l0ZW0vVG9kb0l0ZW1Db250cm9sbGVyLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Qcm9qZWN0L1Byb2plY3RDb250cm9sbGVyLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Qcm9qZWN0L1Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9tb2R1bGVzL1Byb2plY3RUb2RvSXRlbU1lZGlhdG9yLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Ub2RvSXRlbS9Ub2RvSXRlbURldGFpbC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvUHJvamVjdC9Qcm9qZWN0TGlzdC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvTGF5b3V0L2hlYWRlci5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvUHJvamVjdC9Qcm9qZWN0RGV0YWlsLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgUHViU3ViIHtcclxuICAgIGV2ZW50cyA9IHt9O1xyXG5cclxuICAgIHB1Ymxpc2goZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgcHVibGlzaCBjYWxsZWQgZm9yIGV2ZW50ICR7ZXZlbnR9IHdpdGggZGF0YSAke0pTT04uc3RyaW5naWZ5KGRhdGEpfWApXHJcbiAgICAgICAgaWYgKCF0aGlzLmV2ZW50c1tldmVudF0pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChsZXQgbGlzdGVuZXIgb2YgdGhpcy5ldmVudHNbZXZlbnRdKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBjYWxsaW5nICR7bGlzdGVuZXJ9IGZvciAke2V2ZW50fWApXHJcbiAgICAgICAgICAgIGxpc3RlbmVyKGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzdWJzY3JpYmUoZXZlbnQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYHN1YnNjcmliZTogJHtldmVudH0sICR7Y2FsbGJhY2t9YClcclxuICAgICAgICBpZiAoIXRoaXMuZXZlbnRzW2V2ZW50XSkge1xyXG4gICAgICAgICAgICB0aGlzLmV2ZW50c1tldmVudF0gPSBbXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50XS5wdXNoKGNhbGxiYWNrKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgJHtjYWxsYmFja30gc3Vic2NyaWJlZCB0byAke2V2ZW50fWApXHJcbiAgICB9XHJcblxyXG4gICAgdW5zdWJzY3JpYmUoZXZlbnQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmV2ZW50c1tldmVudF0pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5ldmVudHNbZXZlbnRdLnJlbW92ZShcclxuICAgICAgICAgICAgdGhpcy5ldmVudHNbZXZlbnRdLmZpbmQobGlzdGVuZXIgPT4gbGlzdGVuZXIgPT09IGNhbGxiYWNrKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IG5ldyBQdWJTdWIoKTsiLCJleHBvcnQgY2xhc3MgVG9kb0l0ZW0ge1xyXG4gICAgY29uc3RydWN0b3IoaWQsIHRpdGxlLCBkZXNjcmlwdGlvbiwgZHVlRGF0ZSwgcHJvamVjdElkKSB7XHJcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xyXG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XHJcbiAgICAgICAgdGhpcy5kdWVEYXRlID0gZHVlRGF0ZTtcclxuICAgICAgICB0aGlzLmlzQ29tcGxldGUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnByb2plY3RJZCA9IHByb2plY3RJZCB8fCAxO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFB1YlN1YiBmcm9tIFwiLi9QdWJTdWJcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXROZXh0SWQoYXJyKSB7XHJcbiAgICBpZiAoYXJyLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiAxO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyci5yZWR1Y2UoKHByZXZpb3VzLCBpdGVtKSA9PiB7XHJcbiAgICAgICAgY29uc3QgbmV4dCA9IHByZXZpb3VzLmlkIDwgaXRlbS52YWx1ZSA/IGl0ZW0gOiBwcmV2aW91c1xyXG4gICAgICAgIHJldHVybiBuZXh0O1xyXG4gICAgfSkuaWQgKyAxO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcHVibGlzaExpbmsocGFnZSwgZGF0YSkge1xyXG4gICAgUHViU3ViLnB1Ymxpc2goJ2NoYW5nZVBhZ2UnLCB7XHJcbiAgICAgICAgcGFnZSxcclxuICAgICAgICBkYXRhXHJcbiAgICB9KTtcclxufSIsImltcG9ydCB7IFRvZG9JdGVtIH0gZnJvbSBcIi4vVG9kb0l0ZW1cIjtcclxuaW1wb3J0IHsgZ2V0TmV4dElkIH0gZnJvbSBcIi4uL3V0aWxcIjtcclxuXHJcbmNvbnN0IHRvZG9JdGVtcyA9IFtdO1xyXG5cclxuZnVuY3Rpb24gYWRkVG9kb0l0ZW0odGl0bGUsIGRlc2NyaXB0aW9uLCBkdWVEYXRlKSB7XHJcbiAgICBjb25zdCBuZXdJZCA9IGdldE5leHRJZCh0b2RvSXRlbXMpO1xyXG4gICAgY29uc3QgbmV3VG9kb0l0ZW0gPSBuZXcgVG9kb0l0ZW0obmV3SWQsIHRpdGxlLCBkZXNjcmlwdGlvbiwgZHVlRGF0ZSk7XHJcbiAgICB0b2RvSXRlbXMucHVzaChuZXdUb2RvSXRlbSk7XHJcbiAgICByZXR1cm4gbmV3VG9kb0l0ZW07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFRvZG9JdGVtcygpIHtcclxuICAgIHJldHVybiB0b2RvSXRlbXM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFRvZG9JdGVtQnlJZChpZCkge1xyXG4gICAgcmV0dXJuIHRvZG9JdGVtcy5maW5kKGl0ZW0gPT4gaXRlbS5pZCA9PT0gaWQpO1xyXG59XHJcblxyXG5leHBvcnQgeyBhZGRUb2RvSXRlbSwgZ2V0VG9kb0l0ZW1zLCBnZXRUb2RvSXRlbUJ5SWQgfTsiLCJpbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4vUHJvamVjdFwiO1xyXG5pbXBvcnQgeyBnZXROZXh0SWQgfSBmcm9tIFwiLi4vdXRpbFwiO1xyXG5cclxuY29uc3QgcHJvamVjdHMgPSBbXHJcbiAgICBuZXcgUHJvamVjdCgxLCBcIkRlZmF1bHRcIiksXHJcbl07XHJcblxyXG5mdW5jdGlvbiBhZGRQcm9qZWN0KG5hbWUpIHtcclxuICAgIGNvbnN0IG5ld0lkID0gZ2V0TmV4dElkKHByb2plY3RzKTtcclxuICAgIGNvbnN0IG5ld1Byb2plY3QgPSBuZXcgUHJvamVjdChuZXdJZCwgbmFtZSk7XHJcbiAgICBwcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xyXG4gICAgcmV0dXJuIG5ld1Byb2plY3Q7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFByb2plY3RzKCkge1xyXG4gICAgcmV0dXJuIHByb2plY3RzO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRQcm9qZWN0QnlJZChpZCkge1xyXG4gICAgcmV0dXJuIHByb2plY3RzLmZpbmQocHJvamVjdCA9PiBwcm9qZWN0LmlkID09PSBpZCk7XHJcbn1cclxuXHJcbmV4cG9ydCB7IGFkZFByb2plY3QsIGdldFByb2plY3RzLCBnZXRQcm9qZWN0QnlJZCB9IiwiZXhwb3J0IGNsYXNzIFByb2plY3Qge1xyXG4gICAgY29uc3RydWN0b3IoaWQsIG5hbWUpIHtcclxuICAgICAgICB0aGlzLmlkID0gaWQ7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIH1cclxufSIsImltcG9ydCB7IGdldFRvZG9JdGVtcyB9IGZyb20gXCIuL1RvZG9JdGVtL1RvZG9JdGVtQ29udHJvbGxlclwiO1xyXG5pbXBvcnQgeyBnZXRQcm9qZWN0QnlJZCB9IGZyb20gXCIuL1Byb2plY3QvUHJvamVjdENvbnRyb2xsZXJcIjtcclxuXHJcblxyXG5jbGFzcyBQcm9qZWN0VG9kb0l0ZW1NZWRpYXRvciB7XHJcbiAgICBnZXRQcm9qZWN0QnlJZChpZCkge1xyXG4gICAgICAgIHJldHVybiBnZXRQcm9qZWN0QnlJZChpZCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VG9kb0l0ZW1zRm9yUHJvamVjdChwcm9qZWN0SWQpIHtcclxuICAgICAgICByZXR1cm4gZ2V0VG9kb0l0ZW1zKCkuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9qZWN0SWQgPT09IHByb2plY3RJZCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IG5ldyBQcm9qZWN0VG9kb0l0ZW1NZWRpYXRvcigpO1xyXG5cclxuIiwiaW1wb3J0IHsgZ2V0VG9kb0l0ZW1CeUlkIH0gZnJvbSBcIi4vVG9kb0l0ZW1Db250cm9sbGVyXCI7XHJcbmltcG9ydCBQcm9qZWN0VG9kb0l0ZW1NZWRpYXRvciBmcm9tIFwiLi4vUHJvamVjdFRvZG9JdGVtTWVkaWF0b3JcIjtcclxuaW1wb3J0IHsgcHVibGlzaExpbmsgfSBmcm9tIFwiLi4vdXRpbFwiO1xyXG5jbGFzcyBUb2RvSXRlbURldGFpbCB7XHJcbiAgICByZW5kZXIoaWQpIHtcclxuICAgICAgICBjb25zdCB0b2RvSXRlbSA9IGdldFRvZG9JdGVtQnlJZChpZCk7XHJcbiAgICAgICAgaWYgKCF0b2RvSXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHByb2plY3QgPSBQcm9qZWN0VG9kb0l0ZW1NZWRpYXRvci5nZXRQcm9qZWN0QnlJZCh0b2RvSXRlbS5wcm9qZWN0SWQpO1xyXG4gICAgICAgIGNvbnN0IHRvZG9JdGVtRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBcclxuICAgICAgICBjb25zdCB0b2RvSXRlbUhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XHJcbiAgICAgICAgdG9kb0l0ZW1IZWFkZXIudGV4dENvbnRlbnQgPSB0b2RvSXRlbS50aXRsZTtcclxuICAgIFxyXG4gICAgICAgIGNvbnN0IHRvZG9JdGVtQ29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cclxuICAgICAgICBjb25zdCBwcm9qZWN0RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgcHJvamVjdERpdi50ZXh0Q29udGVudCA9ICdQcm9qZWN0OiAnO1xyXG4gICAgICAgIGNvbnN0IHByb2plY3RMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgIHByb2plY3RMaW5rLmhyZWYgPSAnIyc7XHJcbiAgICAgICAgcHJvamVjdExpbmsudGV4dENvbnRlbnQgPSBwcm9qZWN0Lm5hbWU7XHJcbiAgICAgICAgcHJvamVjdExpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHB1Ymxpc2hMaW5rKCdQcm9qZWN0RGV0YWlsJywgcHJvamVjdC5pZClcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBwcm9qZWN0RGl2LmFwcGVuZENoaWxkKHByb2plY3RMaW5rKTtcclxuICAgICAgICB0b2RvSXRlbUNvbnRlbnQuYXBwZW5kQ2hpbGQocHJvamVjdERpdik7XHJcblxyXG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgZGVzY3JpcHRpb25EaXYudGV4dENvbnRlbnQgPSB0b2RvSXRlbS5kZXNjcmlwdGlvbjtcclxuICAgICAgICB0b2RvSXRlbUNvbnRlbnQuYXBwZW5kQ2hpbGQoZGVzY3JpcHRpb25EaXYpO1xyXG5cclxuICAgICAgICBjb25zdCBkdWVEYXRlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgZHVlRGF0ZURpdi50ZXh0Q29udGVudCA9IHRvZG9JdGVtLmR1ZURhdGU7XHJcbiAgICAgICAgdG9kb0l0ZW1Db250ZW50LmFwcGVuZENoaWxkKGR1ZURhdGVEaXYpO1xyXG5cclxuICAgICAgICBjb25zdCBpc0NvbXBsZXRlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgaXNDb21wbGV0ZURpdi50ZXh0Q29udGVudCA9IHRvZG9JdGVtLmlzQ29tcGxldGU7XHJcbiAgICAgICAgdG9kb0l0ZW1Db250ZW50LmFwcGVuZENoaWxkKGlzQ29tcGxldGVEaXYpO1xyXG4gICAgICAgIFxyXG4gICAgXHJcbiAgICAgICAgdG9kb0l0ZW1EaXYuYXBwZW5kQ2hpbGQodG9kb0l0ZW1IZWFkZXIpO1xyXG4gICAgICAgIHRvZG9JdGVtRGl2LmFwcGVuZENoaWxkKHRvZG9JdGVtQ29udGVudCk7XHJcbiAgICBcclxuICAgICAgICByZXR1cm4gdG9kb0l0ZW1EaXY7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IG5ldyBUb2RvSXRlbURldGFpbCgpOyIsImltcG9ydCB7IGdldFByb2plY3RzIH0gZnJvbSBcIi4vUHJvamVjdENvbnRyb2xsZXJcIjtcclxuaW1wb3J0IHsgcHVibGlzaExpbmsgfSBmcm9tIFwiLi4vdXRpbFwiO1xyXG5jbGFzcyBQcm9qZWN0TGlzdCB7XHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgY29uc3QgcHJvamVjdHMgPSBnZXRQcm9qZWN0cygpO1xyXG4gICAgICAgIGNvbnN0IHByb2plY3RMaXN0Q29udGFpbmVyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgcHJvamVjdExpc3RDb250YWluZXJEaXYuY2xhc3NMaXN0LmFkZCgncHJvamVjdC1saXN0LWNvbnRhaW5lcicpO1xyXG4gICAgXHJcbiAgICAgICAgY29uc3QgcHJvamVjdExpc3RIZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xyXG4gICAgICAgIHByb2plY3RMaXN0SGVhZGVyLnRleHRDb250ZW50ID0gXCJQcm9qZWN0c1wiO1xyXG4gICAgXHJcbiAgICAgICAgY29uc3QgcHJvamVjdExpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xyXG4gICAgICAgIHByb2plY3RMaXN0LmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtbGlzdCcpO1xyXG4gICAgXHJcbiAgICAgICAgZm9yIChsZXQgcHJvamVjdCBvZiBwcm9qZWN0cykge1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvamVjdExpc3RJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICAgICAgICAgICAgcHJvamVjdExpc3RJdGVtLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtbGlzdC1pdGVtJyk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0TGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgICAgICAgICAgcHJvamVjdExpbmsuaHJlZj1cIiNcIjtcclxuICAgICAgICAgICAgcHJvamVjdExpbmsudGV4dENvbnRlbnQgPSBwcm9qZWN0Lm5hbWU7XHJcbiAgICAgICAgICAgIHByb2plY3RMaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHRoaXMub25Qcm9qZWN0TGlua0NsaWNrKGUsIHByb2plY3QpKTtcclxuICAgIFxyXG4gICAgICAgICAgICBwcm9qZWN0TGlzdEl0ZW0uYXBwZW5kQ2hpbGQocHJvamVjdExpbmspO1xyXG4gICAgICAgICAgICBwcm9qZWN0TGlzdC5hcHBlbmRDaGlsZChwcm9qZWN0TGlzdEl0ZW0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBwcm9qZWN0TGlzdENvbnRhaW5lckRpdi5hcHBlbmRDaGlsZChwcm9qZWN0TGlzdEhlYWRlcik7XHJcbiAgICAgICAgcHJvamVjdExpc3RDb250YWluZXJEaXYuYXBwZW5kQ2hpbGQocHJvamVjdExpc3QpO1xyXG4gICAgXHJcbiAgICAgICAgcmV0dXJuIHByb2plY3RMaXN0Q29udGFpbmVyRGl2O1xyXG4gICAgfVxyXG5cclxuICAgIG9uUHJvamVjdExpbmtDbGljayhlLCBwcm9qZWN0KSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHtwcm9qZWN0fSk7XHJcbiAgICAgICAgcHVibGlzaExpbmsoJ1Byb2plY3REZXRhaWwnLCAxKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgbmV3IFByb2plY3RMaXN0KCk7IiwiaW1wb3J0IFB1YlN1YiBmcm9tIFwiLi4vUHViU3ViXCI7XHJcblxyXG5jbGFzcyBIZWFkZXIge1xyXG4gICAgcGFnZUxpbmtzID0gW1xyXG4gICAgICAgIHtuYW1lOiAnUHJvamVjdHMnLHBhZ2U6ICdQcm9qZWN0TGlzdCd9XHJcbiAgICBdXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaGVhZGVyJyk7XHJcbiAgICAgICAgY29uc3QgbmF2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbmF2Jyk7XHJcbiAgICAgICAgY29uc3QgbGlua3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xyXG4gICAgICAgIGxpbmtzLmNsYXNzTGlzdC5hZGQoJ2hlYWRlci1saW5rcycpO1xyXG4gICAgICAgIGZvciAobGV0IHBhZ2Ugb2YgdGhpcy5wYWdlTGlua3MpIHtcclxuICAgICAgICAgICAgY29uc3QgbGlzdEl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gICAgICAgICAgICBsaXN0SXRlbS5jbGFzc0xpc3QuYWRkKCdoZWFkZXItbGluay1pdGVtJyk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBsaXN0SXRlbUxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgICAgIGxpc3RJdGVtTGluay5ocmVmID0gJyMnO1xyXG4gICAgICAgICAgICBsaXN0SXRlbUxpbmsudGV4dENvbnRlbnQgPSBwYWdlLm5hbWU7XHJcbiAgICAgICAgICAgIGxpc3RJdGVtTGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB0aGlzLm9uSGVhZGVyTGlua0NsaWNrKGUsIHBhZ2UpKTtcclxuICAgICAgICAgICAgbGlzdEl0ZW0uYXBwZW5kQ2hpbGQobGlzdEl0ZW1MaW5rKTtcclxuXHJcbiAgICAgICAgICAgIGxpbmtzLmFwcGVuZENoaWxkKGxpc3RJdGVtKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbmF2LmFwcGVuZENoaWxkKGxpbmtzKTtcclxuXHJcbiAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKG5hdik7XHJcbiAgICAgICAgcmV0dXJuIGhlYWRlcjtcclxuICAgIH1cclxuXHJcbiAgICBvbkhlYWRlckxpbmtDbGljayhlLCBuZXdQYWdlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdjaGFuZ2VQYWdlJywge3BhZ2U6IG5ld1BhZ2UucGFnZX0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBuZXcgSGVhZGVyKCk7IiwiaW1wb3J0IFByb2plY3RUb2RvSXRlbU1lZGlhdG9yIGZyb20gXCIuLi9Qcm9qZWN0VG9kb0l0ZW1NZWRpYXRvclwiO1xyXG5pbXBvcnQgeyBwdWJsaXNoTGluayB9IGZyb20gXCIuLi91dGlsXCI7XHJcbmltcG9ydCB7IGdldFByb2plY3RCeUlkIH0gZnJvbSBcIi4vUHJvamVjdENvbnRyb2xsZXJcIjtcclxuXHJcbmNsYXNzIFByb2plY3REZXRhaWwge1xyXG4gICAgcmVuZGVyKGlkKSB7XHJcbiAgICAgICAgY29uc3QgcHJvamVjdCA9IGdldFByb2plY3RCeUlkKGlkKTtcclxuICAgICAgICBjb25zdCB0b2RvSXRlbXMgPSBQcm9qZWN0VG9kb0l0ZW1NZWRpYXRvci5nZXRUb2RvSXRlbXNGb3JQcm9qZWN0KGlkKTtcclxuICAgICAgICBjb25zb2xlLnRhYmxlKHRvZG9JdGVtcyk7XHJcbiAgICAgICAgY29uc3QgcHJvamVjdERldGFpbERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHByb2plY3REZXRhaWxEaXYuY2xhc3NMaXN0LmFkZCgncHJvamVjdC1kZXRhaWwnKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBwcm9qZWN0RGV0YWlsSGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcclxuICAgICAgICBwcm9qZWN0RGV0YWlsSGVhZGVyLnRleHRDb250ZW50ID0gcHJvamVjdC5uYW1lIHx8ICdQcm9qZWN0IERldGFpbHMnO1xyXG4gICAgICAgIHByb2plY3REZXRhaWxEaXYuYXBwZW5kQ2hpbGQocHJvamVjdERldGFpbEhlYWRlcik7XHJcblxyXG4gICAgICAgIGNvbnN0IHRvZG9JdGVtc0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHRvZG9JdGVtc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCd0b2RvLWl0ZW1zLWNvbnRhaW5lcicpO1xyXG5cclxuICAgICAgICBmb3IgKGxldCB0b2RvSXRlbSBvZiB0b2RvSXRlbXMpIHtcclxuICAgICAgICAgICAgY29uc3QgdG9kb0l0ZW1EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgdG9kb0l0ZW1EaXYuY2xhc3NMaXN0LmFkZCgndG9kby1pdGVtJyk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB0b2RvSXRlbUxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgICAgIHRvZG9JdGVtTGluay5ocmVmID0gJyMnO1xyXG4gICAgICAgICAgICB0b2RvSXRlbUxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgcHVibGlzaExpbmsoJ1RvZG9JdGVtRGV0YWlsJywgdG9kb0l0ZW0uaWQpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICBjb25zdCB0b2RvSXRlbUhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcbiAgICAgICAgICAgIHRvZG9JdGVtSGVhZGVyLnRleHRDb250ZW50ID0gdG9kb0l0ZW0udGl0bGU7XHJcbiAgICAgICAgICAgIHRvZG9JdGVtTGluay5hcHBlbmRDaGlsZCh0b2RvSXRlbUhlYWRlcik7XHJcbiAgICAgICAgICAgIHRvZG9JdGVtRGl2LmFwcGVuZENoaWxkKHRvZG9JdGVtTGluayk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB0b2RvSXRlbUR1ZURhdGVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgdG9kb0l0ZW1EdWVEYXRlRGl2LnRleHRDb250ZW50ID0gYER1ZSBkYXRlOiAke3RvZG9JdGVtLmR1ZURhdGV9YDtcclxuICAgICAgICAgICAgdG9kb0l0ZW1EaXYuYXBwZW5kQ2hpbGQodG9kb0l0ZW1EdWVEYXRlRGl2KTtcclxuXHJcbiAgICAgICAgICAgIHRvZG9JdGVtc0NvbnRhaW5lci5hcHBlbmRDaGlsZCh0b2RvSXRlbURpdik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm9qZWN0RGV0YWlsRGl2LmFwcGVuZENoaWxkKHRvZG9JdGVtc0NvbnRhaW5lcik7XHJcbiAgICAgICAgcmV0dXJuIHByb2plY3REZXRhaWxEaXY7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IG5ldyBQcm9qZWN0RGV0YWlsKCk7IiwiaW1wb3J0IFB1YlN1YiBmcm9tICcuL21vZHVsZXMvUHViU3ViJztcclxuaW1wb3J0IHsgYWRkVG9kb0l0ZW0sIGdldFRvZG9JdGVtQnlJZCwgZ2V0VG9kb0l0ZW1zIH0gZnJvbSAnLi9tb2R1bGVzL1RvZG9JdGVtL1RvZG9JdGVtQ29udHJvbGxlcic7XHJcbmltcG9ydCBUb2RvSXRlbURldGFpbCBmcm9tICcuL21vZHVsZXMvVG9kb0l0ZW0vVG9kb0l0ZW1EZXRhaWwnO1xyXG5pbXBvcnQgUHJvamVjdExpc3QgZnJvbSAnLi9tb2R1bGVzL1Byb2plY3QvUHJvamVjdExpc3QnO1xyXG5pbXBvcnQgSGVhZGVyIGZyb20gJy4vbW9kdWxlcy9MYXlvdXQvaGVhZGVyJztcclxuaW1wb3J0IFByb2plY3REZXRhaWwgZnJvbSAnLi9tb2R1bGVzL1Byb2plY3QvUHJvamVjdERldGFpbCc7XHJcbmNvbnNvbGUubG9nKCdUb2RvTGlzdCBhcHAgbG9hZGVkJyk7XHJcbmFkZFRvZG9JdGVtKFwiVGVzdFwiLCBcIlRlc3QgRGVzY3JpcHRpb25cIiwgXCIyMDIyLTEyLTI5XCIpO1xyXG5hZGRUb2RvSXRlbShcIlRlc3QyXCIsIFwiVGVzdCBEZXNjcmlwdGlvbiAyXCIsIFwiMjAyMi0xMi0zMFwiKTtcclxuY29uc29sZS50YWJsZShnZXRUb2RvSXRlbXMoKSk7XHJcblxyXG5jb25zdCBwYWdlcyA9IHtcclxuICAgIFwiVG9kb0l0ZW1EZXRhaWxcIjogVG9kb0l0ZW1EZXRhaWwsXHJcbiAgICBcIlByb2plY3RMaXN0XCI6IFByb2plY3RMaXN0LFxyXG4gICAgXCJQcm9qZWN0RGV0YWlsXCI6UHJvamVjdERldGFpbCxcclxufVxyXG5cclxuUHViU3ViLnN1YnNjcmliZSgnY2hhbmdlUGFnZScsIGNoYW5nZVBhZ2UpO1xyXG5cclxuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChIZWFkZXIucmVuZGVyKCkpO1xyXG5jb25zdCBtYWluQ29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5tYWluQ29udGVudC5jbGFzc0xpc3QuYWRkKCdtYWluLWNvbnRlbnQnKTtcclxuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtYWluQ29udGVudCk7XHJcblxyXG5mdW5jdGlvbiBjaGFuZ2VQYWdlKGRhdGEpIHtcclxuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgaWYgKCFkYXRhLnBhZ2UgfHwgIXBhZ2VzW2RhdGEucGFnZV0pIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbWFpbkNvbnRlbnQuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgIG1haW5Db250ZW50LmFwcGVuZENoaWxkKHBhZ2VzW2RhdGEucGFnZV0ucmVuZGVyKGRhdGEuZGF0YSkpO1xyXG59XHJcblxyXG5jaGFuZ2VQYWdlKHtcclxuICAgIHBhZ2U6IFwiUHJvamVjdExpc3RcIlxyXG59KTtcclxuLy9jaGFuZ2VQYWdlKFRvZG9JdGVtRGV0YWlsLCAxKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdLCJuYW1lcyI6WyJldmVudHMiLCJwdWJsaXNoIiwiZXZlbnQiLCJkYXRhIiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aGlzIiwibGlzdGVuZXIiLCJzdWJzY3JpYmUiLCJjYWxsYmFjayIsInB1c2giLCJ1bnN1YnNjcmliZSIsInJlbW92ZSIsImZpbmQiLCJUb2RvSXRlbSIsImNvbnN0cnVjdG9yIiwiaWQiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwiZHVlRGF0ZSIsInByb2plY3RJZCIsImlzQ29tcGxldGUiLCJwdWJsaXNoTGluayIsInBhZ2UiLCJ0b2RvSXRlbXMiLCJhZGRUb2RvSXRlbSIsIm5ld0lkIiwiYXJyIiwibGVuZ3RoIiwicmVkdWNlIiwicHJldmlvdXMiLCJpdGVtIiwidmFsdWUiLCJuZXdUb2RvSXRlbSIsImdldFRvZG9JdGVtcyIsInByb2plY3RzIiwibmFtZSIsImdldFByb2plY3RzIiwiZ2V0UHJvamVjdEJ5SWQiLCJwcm9qZWN0IiwiZ2V0VG9kb0l0ZW1zRm9yUHJvamVjdCIsImZpbHRlciIsInJlbmRlciIsInRvZG9JdGVtIiwiZ2V0VG9kb0l0ZW1CeUlkIiwidG9kb0l0ZW1EaXYiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ0b2RvSXRlbUhlYWRlciIsInRleHRDb250ZW50IiwidG9kb0l0ZW1Db250ZW50IiwicHJvamVjdERpdiIsInByb2plY3RMaW5rIiwiaHJlZiIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJhcHBlbmRDaGlsZCIsImRlc2NyaXB0aW9uRGl2IiwiZHVlRGF0ZURpdiIsImlzQ29tcGxldGVEaXYiLCJwcm9qZWN0TGlzdENvbnRhaW5lckRpdiIsImNsYXNzTGlzdCIsImFkZCIsInByb2plY3RMaXN0SGVhZGVyIiwicHJvamVjdExpc3QiLCJwcm9qZWN0TGlzdEl0ZW0iLCJvblByb2plY3RMaW5rQ2xpY2siLCJwYWdlTGlua3MiLCJoZWFkZXIiLCJuYXYiLCJsaW5rcyIsImxpc3RJdGVtIiwibGlzdEl0ZW1MaW5rIiwib25IZWFkZXJMaW5rQ2xpY2siLCJuZXdQYWdlIiwidGFibGUiLCJwcm9qZWN0RGV0YWlsRGl2IiwicHJvamVjdERldGFpbEhlYWRlciIsInRvZG9JdGVtc0NvbnRhaW5lciIsInRvZG9JdGVtTGluayIsInRvZG9JdGVtRHVlRGF0ZURpdiIsInBhZ2VzIiwiY2hhbmdlUGFnZSIsImJvZHkiLCJtYWluQ29udGVudCIsImlubmVySFRNTCJdLCJzb3VyY2VSb290IjoiIn0=