(()=>{"use strict";const e=new class{events={};publish(e,t){if(console.log(`publish called for event ${e} with data ${JSON.stringify(t)}`),this.events[e])for(let n of this.events[e])console.log(`calling ${n} for ${e}`),n(t)}subscribe(e,t){console.log(`subscribe: ${e}, ${t}`),this.events[e]||(this.events[e]=[]),this.events[e].push(t),console.log(`${t} subscribed to ${e}`)}unsubscribe(e,t){this.events[e]&&this.events[e].remove(this.events[e].find((e=>e===t)))}};class t{constructor(e,t,n,c,o){this.id=e,this.title=t,this.description=n,this.dueDate=c,this.isComplete=!1,this.projectId=o||1}}function n(t,n){e.publish("changePage",{page:t,data:n})}const c=[];function o(e,n,o){const d=0===(i=c).length?1:i.reduce(((e,t)=>e.id<t.value?t:e)).id+1;var i;const s=new t(d,e,n,o);return c.push(s),s}function d(){return c}const i=[new class{constructor(e,t){this.id=e,this.name=t}}(1,"Default")];function s(){return i}function a(e){return i.find((t=>t.id===e))}const l=new class{getProjectById(e){return a(e)}getTodoItemsForProject(e){return d().filter((t=>t.projectId===e))}},r=new class{render(t){const o=function(e){return c.find((t=>t.id===e))}(t);if(!o)return;const d=l.getProjectById(o.projectId),i=document.createElement("div"),s=document.createElement("h2");s.textContent=o.title;const a=document.createElement("div"),r=document.createElement("div");r.textContent="Project: ";const p=document.createElement("a");p.href="#",p.textContent=d.name,p.addEventListener("click",(e=>{e.preventDefault(),n("ProjectDetail",d.id)})),r.appendChild(p),a.appendChild(r);const u=document.createElement("div");u.textContent=o.description,a.appendChild(u);const m=document.createElement("div");m.textContent=o.dueDate,a.appendChild(m);const h=document.createElement("div");h.textContent=o.isComplete,a.appendChild(h);const C=document.createElement("button");return C.textContent="Delete",C.classList.add("delete-button"),C.addEventListener("click",(t=>{(function(e){c.splice(function(e){return c.findIndex((t=>t.id===e))}(e),1)})(o.id),e.publish("changePage",{page:"ProjectDetail",data:d.id})})),a.appendChild(C),i.appendChild(s),i.appendChild(a),i}},p=new class{render(){const e=s(),t=document.createElement("div");t.classList.add("project-list-container");const n=document.createElement("h2");n.textContent="Projects";const c=document.createElement("ul");c.classList.add("project-list");for(let t of e){const e=document.createElement("li");e.classList.add("project-list-item");const n=document.createElement("a");n.href="#",n.textContent=t.name,n.addEventListener("click",(e=>this.onProjectLinkClick(e,t))),e.appendChild(n),c.appendChild(e)}return t.appendChild(n),t.appendChild(c),t}onProjectLinkClick(e,t){e.preventDefault(),console.log({project:t}),n("ProjectDetail",1)}},u=new class{pageLinks=[{name:"Projects",page:"ProjectList"}];render(){const e=document.createElement("header"),t=document.createElement("nav"),n=document.createElement("ul");n.classList.add("header-links");for(let e of this.pageLinks){const t=document.createElement("li");t.classList.add("header-link-item");const c=document.createElement("a");c.href="#",c.textContent=e.name,c.addEventListener("click",(t=>this.onHeaderLinkClick(t,e))),t.appendChild(c),n.appendChild(t)}return t.appendChild(n),e.appendChild(t),e}onHeaderLinkClick(t,n){t.preventDefault(),e.publish("changePage",{page:n.page})}},m=new class{render(e){const t=a(e),c=l.getTodoItemsForProject(e);console.table(c);const o=document.createElement("div");o.classList.add("project-detail");const d=document.createElement("h2");d.textContent=t.name||"Project Details",o.appendChild(d);const i=document.createElement("div");i.classList.add("todo-items-container");for(let e of c){const t=document.createElement("div");t.classList.add("todo-item");const c=document.createElement("a");c.href="#",c.addEventListener("click",(t=>{t.preventDefault(),n("TodoItemDetail",e.id)}));const o=document.createElement("h3");o.textContent=e.title,c.appendChild(o),t.appendChild(c);const d=document.createElement("div");d.textContent=`Due date: ${e.dueDate}`,t.appendChild(d),i.appendChild(t)}return o.appendChild(i),o}};console.log("TodoList app loaded"),o("Test","Test Description","2022-12-29"),o("Test2","Test Description 2","2022-12-30"),console.table(d());const h={TodoItemDetail:r,ProjectList:p,ProjectDetail:m};e.subscribe("changePage",f),document.body.appendChild(u.render());const C=document.createElement("div");function f(e){console.log(e),e.page&&h[e.page]&&(C.innerHTML="",C.appendChild(h[e.page].render(e.data)))}C.classList.add("main-content"),document.body.appendChild(C),f({page:"ProjectList"})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VixlQUFrQixFQUNsQixZQUFlLEVBQ2YsY0FBZ0IsR0FHcEIsWUFBaUIsYUFBY0MsR0FFL0IxQyxTQUFTMkMsS0FBS2hDLFlBQVksWUFDMUIsTUFBTWlDLEVBQWM1QyxTQUFTQyxjQUFjLE9BSTNDLFNBQVN5QyxFQUFXdkYsR0FDaEJDLFFBQVFDLElBQUlGLEdBQ1BBLEVBQUtzQixNQUFTZ0UsRUFBTXRGLEVBQUtzQixRQUk5Qm1FLEVBQVlDLFVBQVksR0FDeEJELEVBQVlqQyxZQUFZOEIsRUFBTXRGLEVBQUtzQixNQUFNbUIsT0FBT3pDLEVBQUtBLE9BQ3pELENBWEF5RixFQUFZNUIsVUFBVUMsSUFBSSxnQkFDMUJqQixTQUFTMkMsS0FBS2hDLFlBQVlpQyxHQVkxQkYsRUFBVyxDQUNQakUsS0FBTSxlIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9tb2R1bGVzL1B1YlN1Yi5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvVG9kb0l0ZW0vVG9kb0l0ZW0uanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9tb2R1bGVzL3V0aWwuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9tb2R1bGVzL1RvZG9JdGVtL1RvZG9JdGVtQ29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvUHJvamVjdC9Qcm9qZWN0Q29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvUHJvamVjdC9Qcm9qZWN0LmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Qcm9qZWN0VG9kb0l0ZW1NZWRpYXRvci5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvVG9kb0l0ZW0vVG9kb0l0ZW1EZXRhaWwuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9tb2R1bGVzL1Byb2plY3QvUHJvamVjdExpc3QuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9tb2R1bGVzL0xheW91dC9oZWFkZXIuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9tb2R1bGVzL1Byb2plY3QvUHJvamVjdERldGFpbC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFB1YlN1YiB7XHJcbiAgICBldmVudHMgPSB7fTtcclxuXHJcbiAgICBwdWJsaXNoKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYHB1Ymxpc2ggY2FsbGVkIGZvciBldmVudCAke2V2ZW50fSB3aXRoIGRhdGEgJHtKU09OLnN0cmluZ2lmeShkYXRhKX1gKVxyXG4gICAgICAgIGlmICghdGhpcy5ldmVudHNbZXZlbnRdKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IGxpc3RlbmVyIG9mIHRoaXMuZXZlbnRzW2V2ZW50XSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgY2FsbGluZyAke2xpc3RlbmVyfSBmb3IgJHtldmVudH1gKVxyXG4gICAgICAgICAgICBsaXN0ZW5lcihkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc3Vic2NyaWJlKGV2ZW50LCBjYWxsYmFjaykge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBzdWJzY3JpYmU6ICR7ZXZlbnR9LCAke2NhbGxiYWNrfWApXHJcbiAgICAgICAgaWYgKCF0aGlzLmV2ZW50c1tldmVudF0pIHtcclxuICAgICAgICAgICAgdGhpcy5ldmVudHNbZXZlbnRdID0gW107XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmV2ZW50c1tldmVudF0ucHVzaChjYWxsYmFjayk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYCR7Y2FsbGJhY2t9IHN1YnNjcmliZWQgdG8gJHtldmVudH1gKVxyXG4gICAgfVxyXG5cclxuICAgIHVuc3Vic2NyaWJlKGV2ZW50LCBjYWxsYmFjaykge1xyXG4gICAgICAgIGlmICghdGhpcy5ldmVudHNbZXZlbnRdKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50XS5yZW1vdmUoXHJcbiAgICAgICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50XS5maW5kKGxpc3RlbmVyID0+IGxpc3RlbmVyID09PSBjYWxsYmFjaylcclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBuZXcgUHViU3ViKCk7IiwiZXhwb3J0IGNsYXNzIFRvZG9JdGVtIHtcclxuICAgIGNvbnN0cnVjdG9yKGlkLCB0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZURhdGUsIHByb2plY3RJZCkge1xyXG4gICAgICAgIHRoaXMuaWQgPSBpZDtcclxuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgICAgIHRoaXMuZHVlRGF0ZSA9IGR1ZURhdGU7XHJcbiAgICAgICAgdGhpcy5pc0NvbXBsZXRlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5wcm9qZWN0SWQgPSBwcm9qZWN0SWQgfHwgMTtcclxuICAgIH1cclxufSIsImltcG9ydCBQdWJTdWIgZnJvbSBcIi4vUHViU3ViXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmV4dElkKGFycikge1xyXG4gICAgaWYgKGFyci5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gMTtcclxuICAgIH1cclxuICAgIHJldHVybiBhcnIucmVkdWNlKChwcmV2aW91cywgaXRlbSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG5leHQgPSBwcmV2aW91cy5pZCA8IGl0ZW0udmFsdWUgPyBpdGVtIDogcHJldmlvdXNcclxuICAgICAgICByZXR1cm4gbmV4dDtcclxuICAgIH0pLmlkICsgMTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2hMaW5rKHBhZ2UsIGRhdGEpIHtcclxuICAgIFB1YlN1Yi5wdWJsaXNoKCdjaGFuZ2VQYWdlJywge1xyXG4gICAgICAgIHBhZ2UsXHJcbiAgICAgICAgZGF0YVxyXG4gICAgfSk7XHJcbn0iLCJpbXBvcnQgeyBUb2RvSXRlbSB9IGZyb20gXCIuL1RvZG9JdGVtXCI7XHJcbmltcG9ydCB7IGdldE5leHRJZCB9IGZyb20gXCIuLi91dGlsXCI7XHJcbmltcG9ydCBQdWJTdWIgZnJvbSBcIi4uL1B1YlN1YlwiO1xyXG5cclxuY29uc3QgdG9kb0l0ZW1zID0gW107XHJcblxyXG5mdW5jdGlvbiBhZGRUb2RvSXRlbSh0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZURhdGUpIHtcclxuICAgIGNvbnN0IG5ld0lkID0gZ2V0TmV4dElkKHRvZG9JdGVtcyk7XHJcbiAgICBjb25zdCBuZXdUb2RvSXRlbSA9IG5ldyBUb2RvSXRlbShuZXdJZCwgdGl0bGUsIGRlc2NyaXB0aW9uLCBkdWVEYXRlKTtcclxuICAgIHRvZG9JdGVtcy5wdXNoKG5ld1RvZG9JdGVtKTtcclxuICAgIHJldHVybiBuZXdUb2RvSXRlbTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0VG9kb0l0ZW1zKCkge1xyXG4gICAgcmV0dXJuIHRvZG9JdGVtcztcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0VG9kb0l0ZW1CeUlkKGlkKSB7XHJcbiAgICByZXR1cm4gdG9kb0l0ZW1zLmZpbmQoaXRlbSA9PiBpdGVtLmlkID09PSBpZCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldEluZGV4RnJvbUlkKGlkKSB7XHJcbiAgICByZXR1cm4gdG9kb0l0ZW1zLmZpbmRJbmRleChpdGVtID0+IGl0ZW0uaWQgPT09IGlkKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGVsZXRlVG9kb0l0ZW0oaWQpIHtcclxuICAgIHRvZG9JdGVtcy5zcGxpY2UoZ2V0SW5kZXhGcm9tSWQoaWQpLCAxKTtcclxufVxyXG5cclxuZXhwb3J0IHsgYWRkVG9kb0l0ZW0sIGdldFRvZG9JdGVtcywgZ2V0VG9kb0l0ZW1CeUlkLCBkZWxldGVUb2RvSXRlbSB9OyIsImltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi9Qcm9qZWN0XCI7XHJcbmltcG9ydCB7IGdldE5leHRJZCB9IGZyb20gXCIuLi91dGlsXCI7XHJcblxyXG5jb25zdCBwcm9qZWN0cyA9IFtcclxuICAgIG5ldyBQcm9qZWN0KDEsIFwiRGVmYXVsdFwiKSxcclxuXTtcclxuXHJcbmZ1bmN0aW9uIGFkZFByb2plY3QobmFtZSkge1xyXG4gICAgY29uc3QgbmV3SWQgPSBnZXROZXh0SWQocHJvamVjdHMpO1xyXG4gICAgY29uc3QgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KG5ld0lkLCBuYW1lKTtcclxuICAgIHByb2plY3RzLnB1c2gobmV3UHJvamVjdCk7XHJcbiAgICByZXR1cm4gbmV3UHJvamVjdDtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0UHJvamVjdHMoKSB7XHJcbiAgICByZXR1cm4gcHJvamVjdHM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFByb2plY3RCeUlkKGlkKSB7XHJcbiAgICByZXR1cm4gcHJvamVjdHMuZmluZChwcm9qZWN0ID0+IHByb2plY3QuaWQgPT09IGlkKTtcclxufVxyXG5cclxuZXhwb3J0IHsgYWRkUHJvamVjdCwgZ2V0UHJvamVjdHMsIGdldFByb2plY3RCeUlkIH0iLCJleHBvcnQgY2xhc3MgUHJvamVjdCB7XHJcbiAgICBjb25zdHJ1Y3RvcihpZCwgbmFtZSkge1xyXG4gICAgICAgIHRoaXMuaWQgPSBpZDtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgZ2V0VG9kb0l0ZW1zIH0gZnJvbSBcIi4vVG9kb0l0ZW0vVG9kb0l0ZW1Db250cm9sbGVyXCI7XHJcbmltcG9ydCB7IGdldFByb2plY3RCeUlkIH0gZnJvbSBcIi4vUHJvamVjdC9Qcm9qZWN0Q29udHJvbGxlclwiO1xyXG5cclxuXHJcbmNsYXNzIFByb2plY3RUb2RvSXRlbU1lZGlhdG9yIHtcclxuICAgIGdldFByb2plY3RCeUlkKGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGdldFByb2plY3RCeUlkKGlkKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRUb2RvSXRlbXNGb3JQcm9qZWN0KHByb2plY3RJZCkge1xyXG4gICAgICAgIHJldHVybiBnZXRUb2RvSXRlbXMoKS5maWx0ZXIoaXRlbSA9PiBpdGVtLnByb2plY3RJZCA9PT0gcHJvamVjdElkKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgbmV3IFByb2plY3RUb2RvSXRlbU1lZGlhdG9yKCk7XHJcblxyXG4iLCJpbXBvcnQgeyBkZWxldGVUb2RvSXRlbSwgZ2V0VG9kb0l0ZW1CeUlkIH0gZnJvbSBcIi4vVG9kb0l0ZW1Db250cm9sbGVyXCI7XHJcbmltcG9ydCBQcm9qZWN0VG9kb0l0ZW1NZWRpYXRvciBmcm9tIFwiLi4vUHJvamVjdFRvZG9JdGVtTWVkaWF0b3JcIjtcclxuaW1wb3J0IHsgcHVibGlzaExpbmsgfSBmcm9tIFwiLi4vdXRpbFwiO1xyXG5pbXBvcnQgUHViU3ViIGZyb20gXCIuLi9QdWJTdWJcIjtcclxuY2xhc3MgVG9kb0l0ZW1EZXRhaWwge1xyXG4gICAgcmVuZGVyKGlkKSB7XHJcbiAgICAgICAgY29uc3QgdG9kb0l0ZW0gPSBnZXRUb2RvSXRlbUJ5SWQoaWQpO1xyXG4gICAgICAgIGlmICghdG9kb0l0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwcm9qZWN0ID0gUHJvamVjdFRvZG9JdGVtTWVkaWF0b3IuZ2V0UHJvamVjdEJ5SWQodG9kb0l0ZW0ucHJvamVjdElkKTtcclxuICAgICAgICBjb25zdCB0b2RvSXRlbURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgXHJcbiAgICAgICAgY29uc3QgdG9kb0l0ZW1IZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xyXG4gICAgICAgIHRvZG9JdGVtSGVhZGVyLnRleHRDb250ZW50ID0gdG9kb0l0ZW0udGl0bGU7XHJcbiAgICBcclxuICAgICAgICBjb25zdCB0b2RvSXRlbUNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHJcbiAgICAgICAgY29uc3QgcHJvamVjdERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHByb2plY3REaXYudGV4dENvbnRlbnQgPSAnUHJvamVjdDogJztcclxuICAgICAgICBjb25zdCBwcm9qZWN0TGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgICAgICBwcm9qZWN0TGluay5ocmVmID0gJyMnO1xyXG4gICAgICAgIHByb2plY3RMaW5rLnRleHRDb250ZW50ID0gcHJvamVjdC5uYW1lO1xyXG4gICAgICAgIHByb2plY3RMaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBwdWJsaXNoTGluaygnUHJvamVjdERldGFpbCcsIHByb2plY3QuaWQpXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHByb2plY3REaXYuYXBwZW5kQ2hpbGQocHJvamVjdExpbmspO1xyXG4gICAgICAgIHRvZG9JdGVtQ29udGVudC5hcHBlbmRDaGlsZChwcm9qZWN0RGl2KTtcclxuXHJcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb25EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBkZXNjcmlwdGlvbkRpdi50ZXh0Q29udGVudCA9IHRvZG9JdGVtLmRlc2NyaXB0aW9uO1xyXG4gICAgICAgIHRvZG9JdGVtQ29udGVudC5hcHBlbmRDaGlsZChkZXNjcmlwdGlvbkRpdik7XHJcblxyXG4gICAgICAgIGNvbnN0IGR1ZURhdGVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBkdWVEYXRlRGl2LnRleHRDb250ZW50ID0gdG9kb0l0ZW0uZHVlRGF0ZTtcclxuICAgICAgICB0b2RvSXRlbUNvbnRlbnQuYXBwZW5kQ2hpbGQoZHVlRGF0ZURpdik7XHJcblxyXG4gICAgICAgIGNvbnN0IGlzQ29tcGxldGVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBpc0NvbXBsZXRlRGl2LnRleHRDb250ZW50ID0gdG9kb0l0ZW0uaXNDb21wbGV0ZTtcclxuICAgICAgICB0b2RvSXRlbUNvbnRlbnQuYXBwZW5kQ2hpbGQoaXNDb21wbGV0ZURpdik7XHJcblxyXG4gICAgICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgICAgIGRlbGV0ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdEZWxldGUnO1xyXG4gICAgICAgIGRlbGV0ZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdkZWxldGUtYnV0dG9uJyk7XHJcbiAgICAgICAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgZGVsZXRlVG9kb0l0ZW0odG9kb0l0ZW0uaWQpO1xyXG4gICAgICAgICAgICBQdWJTdWIucHVibGlzaCgnY2hhbmdlUGFnZScsIHtwYWdlOiAnUHJvamVjdERldGFpbCcsIGRhdGE6IHByb2plY3QuaWR9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0b2RvSXRlbUNvbnRlbnQuYXBwZW5kQ2hpbGQoZGVsZXRlQnV0dG9uKTtcclxuICAgICAgICBcclxuICAgIFxyXG4gICAgICAgIHRvZG9JdGVtRGl2LmFwcGVuZENoaWxkKHRvZG9JdGVtSGVhZGVyKTtcclxuICAgICAgICB0b2RvSXRlbURpdi5hcHBlbmRDaGlsZCh0b2RvSXRlbUNvbnRlbnQpO1xyXG4gICAgXHJcbiAgICAgICAgcmV0dXJuIHRvZG9JdGVtRGl2O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBuZXcgVG9kb0l0ZW1EZXRhaWwoKTsiLCJpbXBvcnQgeyBnZXRQcm9qZWN0cyB9IGZyb20gXCIuL1Byb2plY3RDb250cm9sbGVyXCI7XHJcbmltcG9ydCB7IHB1Ymxpc2hMaW5rIH0gZnJvbSBcIi4uL3V0aWxcIjtcclxuY2xhc3MgUHJvamVjdExpc3Qge1xyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGNvbnN0IHByb2plY3RzID0gZ2V0UHJvamVjdHMoKTtcclxuICAgICAgICBjb25zdCBwcm9qZWN0TGlzdENvbnRhaW5lckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHByb2plY3RMaXN0Q29udGFpbmVyRGl2LmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtbGlzdC1jb250YWluZXInKTtcclxuICAgIFxyXG4gICAgICAgIGNvbnN0IHByb2plY3RMaXN0SGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcclxuICAgICAgICBwcm9qZWN0TGlzdEhlYWRlci50ZXh0Q29udGVudCA9IFwiUHJvamVjdHNcIjtcclxuICAgIFxyXG4gICAgICAgIGNvbnN0IHByb2plY3RMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcclxuICAgICAgICBwcm9qZWN0TGlzdC5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0LWxpc3QnKTtcclxuICAgIFxyXG4gICAgICAgIGZvciAobGV0IHByb2plY3Qgb2YgcHJvamVjdHMpIHtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RMaXN0SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICAgICAgICAgIHByb2plY3RMaXN0SXRlbS5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0LWxpc3QtaXRlbScpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvamVjdExpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgICAgIHByb2plY3RMaW5rLmhyZWY9XCIjXCI7XHJcbiAgICAgICAgICAgIHByb2plY3RMaW5rLnRleHRDb250ZW50ID0gcHJvamVjdC5uYW1lO1xyXG4gICAgICAgICAgICBwcm9qZWN0TGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB0aGlzLm9uUHJvamVjdExpbmtDbGljayhlLCBwcm9qZWN0KSk7XHJcbiAgICBcclxuICAgICAgICAgICAgcHJvamVjdExpc3RJdGVtLmFwcGVuZENoaWxkKHByb2plY3RMaW5rKTtcclxuICAgICAgICAgICAgcHJvamVjdExpc3QuYXBwZW5kQ2hpbGQocHJvamVjdExpc3RJdGVtKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcHJvamVjdExpc3RDb250YWluZXJEaXYuYXBwZW5kQ2hpbGQocHJvamVjdExpc3RIZWFkZXIpO1xyXG4gICAgICAgIHByb2plY3RMaXN0Q29udGFpbmVyRGl2LmFwcGVuZENoaWxkKHByb2plY3RMaXN0KTtcclxuICAgIFxyXG4gICAgICAgIHJldHVybiBwcm9qZWN0TGlzdENvbnRhaW5lckRpdjtcclxuICAgIH1cclxuXHJcbiAgICBvblByb2plY3RMaW5rQ2xpY2soZSwgcHJvamVjdCkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBjb25zb2xlLmxvZyh7cHJvamVjdH0pO1xyXG4gICAgICAgIHB1Ymxpc2hMaW5rKCdQcm9qZWN0RGV0YWlsJywgMSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IG5ldyBQcm9qZWN0TGlzdCgpOyIsImltcG9ydCBQdWJTdWIgZnJvbSBcIi4uL1B1YlN1YlwiO1xyXG5cclxuY2xhc3MgSGVhZGVyIHtcclxuICAgIHBhZ2VMaW5rcyA9IFtcclxuICAgICAgICB7bmFtZTogJ1Byb2plY3RzJyxwYWdlOiAnUHJvamVjdExpc3QnfVxyXG4gICAgXVxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2hlYWRlcicpO1xyXG4gICAgICAgIGNvbnN0IG5hdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ25hdicpO1xyXG4gICAgICAgIGNvbnN0IGxpbmtzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcclxuICAgICAgICBsaW5rcy5jbGFzc0xpc3QuYWRkKCdoZWFkZXItbGlua3MnKTtcclxuICAgICAgICBmb3IgKGxldCBwYWdlIG9mIHRoaXMucGFnZUxpbmtzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpc3RJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICAgICAgICAgICAgbGlzdEl0ZW0uY2xhc3NMaXN0LmFkZCgnaGVhZGVyLWxpbmstaXRlbScpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbGlzdEl0ZW1MaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgICAgICBsaXN0SXRlbUxpbmsuaHJlZiA9ICcjJztcclxuICAgICAgICAgICAgbGlzdEl0ZW1MaW5rLnRleHRDb250ZW50ID0gcGFnZS5uYW1lO1xyXG4gICAgICAgICAgICBsaXN0SXRlbUxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gdGhpcy5vbkhlYWRlckxpbmtDbGljayhlLCBwYWdlKSk7XHJcbiAgICAgICAgICAgIGxpc3RJdGVtLmFwcGVuZENoaWxkKGxpc3RJdGVtTGluayk7XHJcblxyXG4gICAgICAgICAgICBsaW5rcy5hcHBlbmRDaGlsZChsaXN0SXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5hdi5hcHBlbmRDaGlsZChsaW5rcyk7XHJcblxyXG4gICAgICAgIGhlYWRlci5hcHBlbmRDaGlsZChuYXYpO1xyXG4gICAgICAgIHJldHVybiBoZWFkZXI7XHJcbiAgICB9XHJcblxyXG4gICAgb25IZWFkZXJMaW5rQ2xpY2soZSwgbmV3UGFnZSkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBQdWJTdWIucHVibGlzaCgnY2hhbmdlUGFnZScsIHtwYWdlOiBuZXdQYWdlLnBhZ2V9KTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgbmV3IEhlYWRlcigpOyIsImltcG9ydCBQcm9qZWN0VG9kb0l0ZW1NZWRpYXRvciBmcm9tIFwiLi4vUHJvamVjdFRvZG9JdGVtTWVkaWF0b3JcIjtcclxuaW1wb3J0IHsgcHVibGlzaExpbmsgfSBmcm9tIFwiLi4vdXRpbFwiO1xyXG5pbXBvcnQgeyBnZXRQcm9qZWN0QnlJZCB9IGZyb20gXCIuL1Byb2plY3RDb250cm9sbGVyXCI7XHJcblxyXG5jbGFzcyBQcm9qZWN0RGV0YWlsIHtcclxuICAgIHJlbmRlcihpZCkge1xyXG4gICAgICAgIGNvbnN0IHByb2plY3QgPSBnZXRQcm9qZWN0QnlJZChpZCk7XHJcbiAgICAgICAgY29uc3QgdG9kb0l0ZW1zID0gUHJvamVjdFRvZG9JdGVtTWVkaWF0b3IuZ2V0VG9kb0l0ZW1zRm9yUHJvamVjdChpZCk7XHJcbiAgICAgICAgY29uc29sZS50YWJsZSh0b2RvSXRlbXMpO1xyXG4gICAgICAgIGNvbnN0IHByb2plY3REZXRhaWxEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBwcm9qZWN0RGV0YWlsRGl2LmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtZGV0YWlsJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgcHJvamVjdERldGFpbEhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XHJcbiAgICAgICAgcHJvamVjdERldGFpbEhlYWRlci50ZXh0Q29udGVudCA9IHByb2plY3QubmFtZSB8fCAnUHJvamVjdCBEZXRhaWxzJztcclxuICAgICAgICBwcm9qZWN0RGV0YWlsRGl2LmFwcGVuZENoaWxkKHByb2plY3REZXRhaWxIZWFkZXIpO1xyXG5cclxuICAgICAgICBjb25zdCB0b2RvSXRlbXNDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICB0b2RvSXRlbXNDb250YWluZXIuY2xhc3NMaXN0LmFkZCgndG9kby1pdGVtcy1jb250YWluZXInKTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgdG9kb0l0ZW0gb2YgdG9kb0l0ZW1zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvZG9JdGVtRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIHRvZG9JdGVtRGl2LmNsYXNzTGlzdC5hZGQoJ3RvZG8taXRlbScpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgdG9kb0l0ZW1MaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgICAgICB0b2RvSXRlbUxpbmsuaHJlZiA9ICcjJztcclxuICAgICAgICAgICAgdG9kb0l0ZW1MaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHB1Ymxpc2hMaW5rKCdUb2RvSXRlbURldGFpbCcsIHRvZG9JdGVtLmlkKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgY29uc3QgdG9kb0l0ZW1IZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xyXG4gICAgICAgICAgICB0b2RvSXRlbUhlYWRlci50ZXh0Q29udGVudCA9IHRvZG9JdGVtLnRpdGxlO1xyXG4gICAgICAgICAgICB0b2RvSXRlbUxpbmsuYXBwZW5kQ2hpbGQodG9kb0l0ZW1IZWFkZXIpO1xyXG4gICAgICAgICAgICB0b2RvSXRlbURpdi5hcHBlbmRDaGlsZCh0b2RvSXRlbUxpbmspO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgdG9kb0l0ZW1EdWVEYXRlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIHRvZG9JdGVtRHVlRGF0ZURpdi50ZXh0Q29udGVudCA9IGBEdWUgZGF0ZTogJHt0b2RvSXRlbS5kdWVEYXRlfWA7XHJcbiAgICAgICAgICAgIHRvZG9JdGVtRGl2LmFwcGVuZENoaWxkKHRvZG9JdGVtRHVlRGF0ZURpdik7XHJcblxyXG4gICAgICAgICAgICB0b2RvSXRlbXNDb250YWluZXIuYXBwZW5kQ2hpbGQodG9kb0l0ZW1EaXYpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvamVjdERldGFpbERpdi5hcHBlbmRDaGlsZCh0b2RvSXRlbXNDb250YWluZXIpO1xyXG4gICAgICAgIHJldHVybiBwcm9qZWN0RGV0YWlsRGl2O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBuZXcgUHJvamVjdERldGFpbCgpOyIsImltcG9ydCBQdWJTdWIgZnJvbSAnLi9tb2R1bGVzL1B1YlN1Yic7XHJcbmltcG9ydCB7IGFkZFRvZG9JdGVtLCBnZXRUb2RvSXRlbUJ5SWQsIGdldFRvZG9JdGVtcyB9IGZyb20gJy4vbW9kdWxlcy9Ub2RvSXRlbS9Ub2RvSXRlbUNvbnRyb2xsZXInO1xyXG5pbXBvcnQgVG9kb0l0ZW1EZXRhaWwgZnJvbSAnLi9tb2R1bGVzL1RvZG9JdGVtL1RvZG9JdGVtRGV0YWlsJztcclxuaW1wb3J0IFByb2plY3RMaXN0IGZyb20gJy4vbW9kdWxlcy9Qcm9qZWN0L1Byb2plY3RMaXN0JztcclxuaW1wb3J0IEhlYWRlciBmcm9tICcuL21vZHVsZXMvTGF5b3V0L2hlYWRlcic7XHJcbmltcG9ydCBQcm9qZWN0RGV0YWlsIGZyb20gJy4vbW9kdWxlcy9Qcm9qZWN0L1Byb2plY3REZXRhaWwnO1xyXG5jb25zb2xlLmxvZygnVG9kb0xpc3QgYXBwIGxvYWRlZCcpO1xyXG5hZGRUb2RvSXRlbShcIlRlc3RcIiwgXCJUZXN0IERlc2NyaXB0aW9uXCIsIFwiMjAyMi0xMi0yOVwiKTtcclxuYWRkVG9kb0l0ZW0oXCJUZXN0MlwiLCBcIlRlc3QgRGVzY3JpcHRpb24gMlwiLCBcIjIwMjItMTItMzBcIik7XHJcbmNvbnNvbGUudGFibGUoZ2V0VG9kb0l0ZW1zKCkpO1xyXG5cclxuY29uc3QgcGFnZXMgPSB7XHJcbiAgICBcIlRvZG9JdGVtRGV0YWlsXCI6IFRvZG9JdGVtRGV0YWlsLFxyXG4gICAgXCJQcm9qZWN0TGlzdFwiOiBQcm9qZWN0TGlzdCxcclxuICAgIFwiUHJvamVjdERldGFpbFwiOlByb2plY3REZXRhaWwsXHJcbn1cclxuXHJcblB1YlN1Yi5zdWJzY3JpYmUoJ2NoYW5nZVBhZ2UnLCBjaGFuZ2VQYWdlKTtcclxuXHJcbmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoSGVhZGVyLnJlbmRlcigpKTtcclxuY29uc3QgbWFpbkNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxubWFpbkNvbnRlbnQuY2xhc3NMaXN0LmFkZCgnbWFpbi1jb250ZW50Jyk7XHJcbmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobWFpbkNvbnRlbnQpO1xyXG5cclxuZnVuY3Rpb24gY2hhbmdlUGFnZShkYXRhKSB7XHJcbiAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgIGlmICghZGF0YS5wYWdlIHx8ICFwYWdlc1tkYXRhLnBhZ2VdKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIG1haW5Db250ZW50LmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICBtYWluQ29udGVudC5hcHBlbmRDaGlsZChwYWdlc1tkYXRhLnBhZ2VdLnJlbmRlcihkYXRhLmRhdGEpKTtcclxufVxyXG5cclxuY2hhbmdlUGFnZSh7XHJcbiAgICBwYWdlOiBcIlByb2plY3RMaXN0XCJcclxufSk7XHJcbi8vY2hhbmdlUGFnZShUb2RvSXRlbURldGFpbCwgMSk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iXSwibmFtZXMiOlsiZXZlbnRzIiwicHVibGlzaCIsImV2ZW50IiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJKU09OIiwic3RyaW5naWZ5IiwidGhpcyIsImxpc3RlbmVyIiwic3Vic2NyaWJlIiwiY2FsbGJhY2siLCJwdXNoIiwidW5zdWJzY3JpYmUiLCJyZW1vdmUiLCJmaW5kIiwiVG9kb0l0ZW0iLCJjb25zdHJ1Y3RvciIsImlkIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImR1ZURhdGUiLCJwcm9qZWN0SWQiLCJpc0NvbXBsZXRlIiwicHVibGlzaExpbmsiLCJwYWdlIiwidG9kb0l0ZW1zIiwiYWRkVG9kb0l0ZW0iLCJuZXdJZCIsImFyciIsImxlbmd0aCIsInJlZHVjZSIsInByZXZpb3VzIiwiaXRlbSIsInZhbHVlIiwibmV3VG9kb0l0ZW0iLCJnZXRUb2RvSXRlbXMiLCJwcm9qZWN0cyIsIm5hbWUiLCJnZXRQcm9qZWN0cyIsImdldFByb2plY3RCeUlkIiwicHJvamVjdCIsImdldFRvZG9JdGVtc0ZvclByb2plY3QiLCJmaWx0ZXIiLCJyZW5kZXIiLCJ0b2RvSXRlbSIsImdldFRvZG9JdGVtQnlJZCIsInRvZG9JdGVtRGl2IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwidG9kb0l0ZW1IZWFkZXIiLCJ0ZXh0Q29udGVudCIsInRvZG9JdGVtQ29udGVudCIsInByb2plY3REaXYiLCJwcm9qZWN0TGluayIsImhyZWYiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0IiwiYXBwZW5kQ2hpbGQiLCJkZXNjcmlwdGlvbkRpdiIsImR1ZURhdGVEaXYiLCJpc0NvbXBsZXRlRGl2IiwiZGVsZXRlQnV0dG9uIiwiY2xhc3NMaXN0IiwiYWRkIiwic3BsaWNlIiwiZmluZEluZGV4IiwiZ2V0SW5kZXhGcm9tSWQiLCJkZWxldGVUb2RvSXRlbSIsInByb2plY3RMaXN0Q29udGFpbmVyRGl2IiwicHJvamVjdExpc3RIZWFkZXIiLCJwcm9qZWN0TGlzdCIsInByb2plY3RMaXN0SXRlbSIsIm9uUHJvamVjdExpbmtDbGljayIsInBhZ2VMaW5rcyIsImhlYWRlciIsIm5hdiIsImxpbmtzIiwibGlzdEl0ZW0iLCJsaXN0SXRlbUxpbmsiLCJvbkhlYWRlckxpbmtDbGljayIsIm5ld1BhZ2UiLCJ0YWJsZSIsInByb2plY3REZXRhaWxEaXYiLCJwcm9qZWN0RGV0YWlsSGVhZGVyIiwidG9kb0l0ZW1zQ29udGFpbmVyIiwidG9kb0l0ZW1MaW5rIiwidG9kb0l0ZW1EdWVEYXRlRGl2IiwicGFnZXMiLCJjaGFuZ2VQYWdlIiwiYm9keSIsIm1haW5Db250ZW50IiwiaW5uZXJIVE1MIl0sInNvdXJjZVJvb3QiOiIifQ==